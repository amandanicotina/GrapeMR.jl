<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · GrapeMR</title><meta name="title" content="API · GrapeMR"/><meta property="og:title" content="API · GrapeMR"/><meta property="twitter:title" content="API · GrapeMR"/><meta name="description" content="Documentation for GrapeMR."/><meta property="og:description" content="Documentation for GrapeMR."/><meta property="twitter:description" content="Documentation for GrapeMR."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GrapeMR</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li class="is-active"><a class="tocitem" href>API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/amandanicotina/GrapeMR.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/amandanicotina/GrapeMR.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.RF_pulse_analysis-Tuple{ControlField}" href="#GrapeMR.RF_pulse_analysis-Tuple{ControlField}"><code>GrapeMR.RF_pulse_analysis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RF_pulse_analysis(cf::ControlField; attenuation_ref = 0.0, B1_ref = 1.0, power_ref = 500.0)</code></pre><p>Calculate calibration analysis of shaped pulse</p><pre><code class="nohighlight hljs">### Parameters:
- `cf::ControlField`: The control field object containing the RF waveform.
- `attenuation_ref::Float64`: Reference attenuation in dB (default is 0.0 dB).
- `B1_ref::Float64`: Reference RF field strength in Tesla (default is 1.0 T).
- `power_ref::Float64`: Reference RF power in Watts (default is 500.0 W).

### Returns:
A tuple of calculated values:
- `max_amp`: Maximum RF amplitude in Hertz (Hz).
- `max_amp_tesla`: Maximum RF amplitude in microtesla (µT).
- `attenuation_B1`: Attenuation in decibels (dB).
- `power_max_B1`: Maximum power in Watts (W).
- `power_average`: Average power in Watts (W).
- `pulse_energy`: Pulse energy in Joules (J).</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/analysis/rf_analysis.jl#L43-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.amplitudes_and_phases-Tuple{ControlField}" href="#GrapeMR.amplitudes_and_phases-Tuple{ControlField}"><code>GrapeMR.amplitudes_and_phases</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">amplitudes_and_phases(cf::ControlField)</code></pre><p>Calculates amplitudes and phases in Hz and radians</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/analysis/rf_analysis.jl#L28-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.bSSFP_RF-Tuple{Int64, Int64, Real, Float64}" href="#GrapeMR.bSSFP_RF-Tuple{Int64, Int64, Real, Float64}"><code>GrapeMR.bSSFP_RF</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bSSFP_RF(N::Int, nTR::Int, α::Real, TR::Float64)</code></pre><p>Generates a bSSFP pulse sequence with bandwidth BW and flip angle flip_angle in radians</p><p><strong>Arguments</strong></p><ul><li><code>N::Int</code>: Points</li><li><code>nTR::Int</code>: How many TRs</li><li><code>α::Real</code>: Flip angle</li><li>`TR::Float64: Repetition time TR in seconds</li></ul><p><strong>Output</strong></p><ul><li>Nx1 array with bSSFP pulse amplitudes</li></ul><p><strong>Example</strong></p><p>```julia bSSFP(gp<em>output, folder</em>path=&quot;/path/to/folder&quot;)</p><p>If no path is provided, it saves the files inside the folder where the package was installed folder name format : yyyy-mm-dd</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/utilities/rf_shapes.jl#L172-L192">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.bandwidth_factor-Tuple{}" href="#GrapeMR.bandwidth_factor-Tuple{}"><code>GrapeMR.bandwidth_factor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bandwidth_factor(cf::ControlField)</code></pre><p>Excitation frequency range</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/analysis/rf_analysis.jl#L150-L155">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.bloch_matrix-NTuple{5, Float64}" href="#GrapeMR.bloch_matrix-NTuple{5, Float64}"><code>GrapeMR.bloch_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bloch_matrix(B1x::Float64, B1y::Float64, Bz::Float64, Γ1::Float64, Γ2::Float64)</code></pre><p>bloch_matrix     # Input       B1x: (::Float64) - B1x step     B1y: (::Float64) - B1x step     Bz:  (::Float64) - B1x step     Γ1:  (::Float64) - B1x step     Γ2:  (::Float64) - B1x step</p><pre><code class="nohighlight hljs"># Output
- Calculated 4x4 Bloch matrix</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/propagation&amp;cost/bloch_methods.jl#L2-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.bohb_hyperopt-Tuple{Vector{&lt;:Spins}, GrapeParams, LinRange, Int64}" href="#GrapeMR.bohb_hyperopt-Tuple{Vector{&lt;:Spins}, GrapeParams, LinRange, Int64}"><code>GrapeMR.bohb_hyperopt</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hyperoptimization(spins::Vector{&lt;:Spins}, 
                  gp::GrapeParams, 
                  Tc::LinRange, 
                  max_iter::Int; 
                  i::Int=5, 
                  poly_start::Vector{Float64}=[1e-1, 1e-2], 
                  poly_degree::Vector{Int}=[1, 2, 3], 
                  B1ref::Float64=1.0)</code></pre><p>Performs hyperparameter optimization using Bayesian Optimization and Hyperband (BOHB) for selecting hyperparameters.</p><pre><code class="nohighlight hljs">### Input
- `spins::Vector{&lt;:Spins}`: A vector containing spin systems for the optimization process.
- `gp::GrapeParams`: Grape algorithm parameters, which include time points, cost function, and mask for which fields are being optimized.
- `Tc::LinRange`: Range for the time control points for spline interpolation.
- `max_iter::Int`: Maximum number of iterations for the optimizer.
- `i::Int=5`: Number of optimization evaluations.
- `poly_start::Vector{Float64}=[1e-1, 1e-2]`: Starting points for the polynomial learning rate.
- `poly_degree::Vector{Int}=[1, 2, 3]`: Degrees for the polynomial learning rate.
- `B1ref::Float64=1.0`: Reference B1 field amplitude for the RF pulse.

### Output
- An optimized object from the BOHB optimization process, containing results and optimization history.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/optimization/hyperparameter_opt.jl#L60-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.bruker_normalized_amplitudes_and_phases-Tuple{ControlField}" href="#GrapeMR.bruker_normalized_amplitudes_and_phases-Tuple{ControlField}"><code>GrapeMR.bruker_normalized_amplitudes_and_phases</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bruker_normalized_amplitudes_and_phases(cf::ControlField)</code></pre><p>Calculates amplitudes and phases normalized to 100 and 180 deg for Bruker implementation on TopSpin. All negative phase values are added a 360deg phase</p><pre><code class="nohighlight hljs">### Parameters:
- `cf::ControlField`: The control field object containing the RF waveform.

### Returns:
A tuple of normalized amplitudes and phases:
- `norm_amp`: Maximum RF amplitude in Hertz (Hz).
- `norm_phase`: Normalize phases in degrees.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/analysis/rf_analysis.jl#L126-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.calculate_cost_gradient-Tuple{Symbolics.Num, Dict, Vector{Symbolics.Num}}" href="#GrapeMR.calculate_cost_gradient-Tuple{Symbolics.Num, Dict, Vector{Symbolics.Num}}"><code>GrapeMR.calculate_cost_gradient</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_cost_gradient(cost_func::Num, dict::Dict, vars::Vector{Num})</code></pre><p>Generic function that maps variables into the gradient calculation using the Symbolics package     dM = Differential(vars[])     dCost<em>M = expand</em>derivatives(dM(cost<em>func))     P = Symbolics.unwrap(substitute.(dCost</em>M, (dict,))[1])</p><p><strong>Input</strong></p><pre><code class="nohighlight hljs">- &#39;cost_func::Num&#39;: Cost Function from pre-defined dictionary
- &#39;dict::Dict&#39;: Variable dictionary
- &#39;vars::Vector{Num}&#39;: Function variables, Mx, My, etc.</code></pre><p><strong>Output</strong></p><pre><code class="nohighlight hljs">- &#39;cost_gradient::Vector{Float64}&#39;:</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/propagation&amp;cost/cost_functions.jl#L25-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.complex_signal-Tuple{ControlField}" href="#GrapeMR.complex_signal-Tuple{ControlField}"><code>GrapeMR.complex_signal</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">complex_signal(cf::ControlField)</code></pre><p>Calculates complex RF signal in Hz</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/analysis/rf_analysis.jl#L5-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.cost_function-Tuple{Isochromat, Symbol}" href="#GrapeMR.cost_function-Tuple{Isochromat, Symbol}"><code>GrapeMR.cost_function</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> cost_function(iso::Isochromat, cf::Symbol)</code></pre><p>Function that gets called cost function form the cost function dictionary</p><p><strong>Input</strong></p><pre><code class="nohighlight hljs">- &#39;iso::Isochromat&#39;: IRespective isochromat for the calculation
- &#39;cf::Symbol&#39;: Cost Function</code></pre><p><strong>Output</strong></p><pre><code class="nohighlight hljs">- &#39;(cost_val, cost_gradient)::Tuple{Float64, Vector{Float64}}&#39;: Tuple with cost funciton value and 4x1 gradient.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/propagation&amp;cost/cost_functions.jl#L2-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.cost_offsets-Tuple{ControlField, Spin, Vector{Float64}, Symbol}" href="#GrapeMR.cost_offsets-Tuple{ControlField, Spin, Vector{Float64}, Symbol}"><code>GrapeMR.cost_offsets</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cost_offsets(control_field::ControlField, spin_system::Spin, offsets::Vector{Float64})</code></pre><p>Calculates the cost values for a given control field (<code>control_field</code>) and spin system (<code>spin_system</code>) over a range of B0 inhomogeneities (<code>offsets</code>).</p><pre><code class="nohighlight hljs"># Arguments
- `control_field::ControlField`: The control field object that contains the RF pulse sequence.
- `spin_system::Spin`: The spin system for which the cost function is to be calculated.
- `offsets::Vector{Float64}`: A vector of offset frequencies (in Hz) representing B0 inhomogeneities.

# Returns
- `cost_values::Vector{Float64}`: A vector containing the cost values corresponding to each offset in `B0_values`.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/analysis/cost_analysis.jl#L2-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.countour_cost-Tuple{Matrix{Float64}}" href="#GrapeMR.countour_cost-Tuple{Matrix{Float64}}"><code>GrapeMR.countour_cost</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">countour_cost(cost_matrix::Matrix{Float64})</code></pre><p>Creates a contour plot of the cost function values over the range of B0 and B1 inhomogeneities.</p><pre><code class="nohighlight hljs"># Arguments
- `cost_matrix::Matrix{Float64}`: A 2D matrix representing the cost values for combinations of B0 and B1 inhomogeneities.

# Returns
- `c::Plot`: A contour plot of the cost function map.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/analysis/cost_analysis.jl#L142-L152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.create_cost_matrix-Tuple{ControlField, Spin, Vector{Float64}, Vector{Float64}, Symbol}" href="#GrapeMR.create_cost_matrix-Tuple{ControlField, Spin, Vector{Float64}, Vector{Float64}, Symbol}"><code>GrapeMR.create_cost_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_cost_matrix(control_field::ControlField, spin_system::Spin, offsets::Vector{Float64}, b1_inhomogeneities::Vector{Float64})</code></pre><p>Generates a cost matrix representing the cost function values across a range of B0 and B1 inhomogeneities.</p><pre><code class="nohighlight hljs"># Arguments
- `control_field::ControlField`: The control field object that contains the RF pulse sequence
- `spin_system::Spin`: The spin system for which the cost function is to be calculated.
- `offsets::Vector{Float64}`: A vector of offset frequencies (in Hz) representing B0 inhomogeneities.
- `b1_inhomogeneities::Vector{Float64}`: A vector representing B1 inhomogeneity percentages.

# Returns
- `cost_matrix::Matrix{Float64}`: A 2D matrix where each element represents the cost value for a particular 
                                    combination of B0 and B1 values. The matrix is normalized by its maximum value.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/analysis/cost_analysis.jl#L40-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.create_folder-Tuple{String}" href="#GrapeMR.create_folder-Tuple{String}"><code>GrapeMR.create_folder</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_folder(path::String)</code></pre><p>Creates a folder at the specified path if it doesn&#39;t already exist.</p><p><strong>Arguments</strong></p><ul><li><code>path::String</code>: The path where the folder will be created.</li></ul><p><strong>Output</strong></p><p>Returns the path to the created folder. If the folder already exists, it simply returns the path.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/utilities/save_data.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.dynamics-Tuple{ControlField, Spin}" href="#GrapeMR.dynamics-Tuple{ControlField, Spin}"><code>GrapeMR.dynamics</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dynamics(cf::ControlField, spins::Spin)</code></pre><p>Function that returns the Isochromat object with the already calculated dynamics.</p><pre><code class="nohighlight hljs"># Input  
- cf::ControlField - Adjoint State
- spins::Spin

# Output
- iso::Isochromat</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/optimization/optimize.jl#L84-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.forward_propagation-Tuple{ControlField, Spins}" href="#GrapeMR.forward_propagation-Tuple{ControlField, Spins}"><code>GrapeMR.forward_propagation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>forward_propagation     # Input       - cf: (::ControlField) - Control fields struct     - s:  (::Spins) - Spin struct</p><pre><code class="nohighlight hljs"># Output
- Magnetization vector 4xN</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/propagation&amp;cost/bloch_methods.jl#L28-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.get_cost_and_gradient-Tuple{Isochromat, Symbolics.Num, Vector{Symbolics.Num}}" href="#GrapeMR.get_cost_and_gradient-Tuple{Isochromat, Symbolics.Num, Vector{Symbolics.Num}}"><code>GrapeMR.get_cost_and_gradient</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_cost_and_gradient(iso::Isochromat, cost_expr::Num, vars::Vector{Num})</code></pre><p>Generic function that maps variables into the gradient calculation using the Symbolics package     dM = Differential(vars[1])     dCost<em>M = expand</em>derivatives(dM(cost<em>func))     P = Symbolics.unwrap(substitute.(dCost</em>M, (dict,))[1])</p><p><strong>Input</strong></p><pre><code class="nohighlight hljs">- &#39;iso::Isochromat&#39;: Isochromts
- &#39;cost_expr::Num&#39;: Cost Function
- &#39;vars::Vector{Num}&#39;: Function variables -&gt; Mx, My, etc.</code></pre><p><strong>Output</strong></p><pre><code class="nohighlight hljs">- &#39;cost_func_val::Float64&#39;: Cost Function Value
- &#39;cost_gradient::Vector{Float64}&#39;:</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/propagation&amp;cost/cost_functions.jl#L47-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.gradient-Tuple{Matrix{Float64}, Matrix{Float64}, Matrix{Int64}}" href="#GrapeMR.gradient-Tuple{Matrix{Float64}, Matrix{Float64}, Matrix{Int64}}"><code>GrapeMR.gradient</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gradient(χ::Matrix{Float64}, M::Matrix{Float64}, H::Matrix)</code></pre><p>gradient     # Input       - χ = (::Matrix{Float64}) - Adjoint State     - M = (::Matrix{Float64}) - Forward Propagation     - H = (::Matrix) - Hamiltonian</p><pre><code class="nohighlight hljs"># Output
- ΔJ - 1xN matrix</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/optimization/optimize.jl#L104-L115">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.grape-Tuple{Parameters, ControlField, Vector{&lt;:Spins}}" href="#GrapeMR.grape-Tuple{Parameters, ControlField, Vector{&lt;:Spins}}"><code>GrapeMR.grape</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">grape(p::Parameters, cf::ControlField, spins::Vector{&lt;:Spins})</code></pre><p>Implements the grape algorithm [<a href="../references/#khaneja2005optimal">1</a>] </p><pre><code class="nohighlight hljs">### Input
- `op::OptimizationParams`: Parameters for the optimization itself: max iterations, 
- `gp::GrapeParams`: Parameters related to Grape itself: time points, cost function, mask for which fields are being optimized.
- `cf::ControlField`: Initial control field - spline function -
- `spins::Vector{&lt;:Spins}`: Vector with all spins included in the optimization

### Output
A scruct cointaing all optimization results:
- `grape_output::GrapeOutput&#39;: Data type with the optimized control fields, spin information and spin dynamics.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/optimization/optimize.jl#L13-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.hard_RF-Tuple{Any, Any, Any}" href="#GrapeMR.hard_RF-Tuple{Any, Any, Any}"><code>GrapeMR.hard_RF</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hard_RF(N::Int, t_c::Float64)</code></pre><p>Generates a cubic spline pulse </p><p><strong>Arguments</strong></p><ul><li><code>N::Int</code>: Points</li><li><code>t_c::Float64</code>: Shaped pulse time in seconds</li></ul><p><strong>Output</strong></p><ul><li>1xN array with spline pulse amplitudes</li></ul><p><strong>Example</strong></p><p>```julia bSSFP(gp<em>output, folder</em>path=&quot;/path/to/folder&quot;)</p><p>If no path is provided, it saves the files inside the folder where the package was installed folder name format : yyyy-mm-dd</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/utilities/rf_shapes.jl#L95-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.heatmap_cost-Tuple{Matrix{Float64}, Vector{Float64}, Vector{Float64}}" href="#GrapeMR.heatmap_cost-Tuple{Matrix{Float64}, Vector{Float64}, Vector{Float64}}"><code>GrapeMR.heatmap_cost</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">heatmap_cost(cost_matrix::Matrix{Float64}, offsets::Vector{Float64}, b1_inhomogeneities::Vector{Float64})</code></pre><p>Generates a heatmap plot of the cost function values over a range of B0 and B1 inhomogeneities.</p><pre><code class="nohighlight hljs"># Arguments
- `cost_matrix::Matrix{Float64}`: A 2D matrix representing the cost values for combinations of B0 and B1 inhomogeneities.
- `offsets::Vector{Float64}`: A vector of offset frequencies (in Hz) used to label the x-axis.
- `b1_inhomogeneities::Vector{Float64}`: A vector representing B1 inhomogeneity percentages used to label the y-axis.

# Returns
- `h::Plot`: A heatmap plot showing the cost function map with a color bar indicating cost values.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/analysis/cost_analysis.jl#L116-L128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.integral_factor-Tuple{ControlField}" href="#GrapeMR.integral_factor-Tuple{ControlField}"><code>GrapeMR.integral_factor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integral_factor(cf::ControlField)</code></pre><p>Power or energy of the RF pulse integrated over its duration</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/analysis/rf_analysis.jl#L166-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.max_peak_amp-Tuple{Vector{ComplexF64}}" href="#GrapeMR.max_peak_amp-Tuple{Vector{ComplexF64}}"><code>GrapeMR.max_peak_amp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">max_peak_amp(B1::Vector{ComplexF64})</code></pre><p>Returns the maximum RF amplitude in Hz</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/analysis/rf_analysis.jl#L13-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.max_peak_amp_tesla-Tuple{Vector{ComplexF64}}" href="#GrapeMR.max_peak_amp_tesla-Tuple{Vector{ComplexF64}}"><code>GrapeMR.max_peak_amp_tesla</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">max_peak_amp_tesla(B1::Vector{ComplexF64})</code></pre><p>Returns the maximum RF amplitude in Tesla</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/analysis/rf_analysis.jl#L20-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.plot_control_fields-Tuple{ControlField}" href="#GrapeMR.plot_control_fields-Tuple{ControlField}"><code>GrapeMR.plot_control_fields</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_control_fields(cf::ControlField; unit::String = &quot;Hz&quot;)</code></pre><p>Plot the control fields of an RF pulse in different units.</p><pre><code class="nohighlight hljs">### Parameters:
- `cf::ControlField`: The control field object containing the RF waveform data (`B1x`, `B1y` components).
- `unit::String`: The unit for the plot. Supported units are:
    - `&quot;Hz&quot;`: Plots `B1x` and `B1y` in Hertz.
    - `&quot;rad/s&quot;`: Converts the control fields to rads/sec and plots the amplitude and phase.
    - `&quot;Tesla&quot;`: Converts the control fields to Tesla using the gyromagnetic ratio for ¹H and plots in microtesla (µT).

### Returns:
- A plot object displaying the control fields in the specified units with amplitude and phase information.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/plots/plots_control_field.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.plot_cost_offset-Tuple{Vector{Float64}, Vector{Float64}}" href="#GrapeMR.plot_cost_offset-Tuple{Vector{Float64}, Vector{Float64}}"><code>GrapeMR.plot_cost_offset</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_cost_offset(cost_profile::Vector{Float64}, B0_values::Vector{Float64})</code></pre><p>Creates a plot of the cost values as a function of B0 offset frequencies.</p><pre><code class="nohighlight hljs"># Arguments
- `cost_profile::Vector{Float64}`: A vector containing the cost values to be plotted.
- `B0_values::Vector{Float64}`: A vector of offset frequencies (in Hz) corresponding to the cost values.

# Returns
- `p::Plot`: A plot object displaying the cost function offset profile.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/analysis/cost_analysis.jl#L88-L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.plot_cost_values-Tuple{Vector{Float64}, GrapeParams}" href="#GrapeMR.plot_cost_values-Tuple{Vector{Float64}, GrapeParams}"><code>GrapeMR.plot_cost_values</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_cost_values(cost::Vector{Float64}, gp::GrapeParams)</code></pre><p>Plot the cost function convergence over iterations during the GRAPE optimization process.</p><pre><code class="nohighlight hljs">### Parameters:
- `cost::Vector{Float64}`: A vector containing the cost values at each iteration.
- `gp::GrapeParams`: The parameters of the GRAPE optimization, including the cost function name.

### Returns:
- A plot object displaying the convergence of the cost function over the iterations.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/plots/plots_control_field.jl#L173-L184">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.plot_magnetization_control_field-Tuple{ControlField, Vector{Isochromat}}" href="#GrapeMR.plot_magnetization_control_field-Tuple{ControlField, Vector{Isochromat}}"><code>GrapeMR.plot_magnetization_control_field</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_magnetization_control_field(cf::ControlField, isos::Vector{Isochromat})</code></pre><p>Plot the magnetization trajectory for a set of isochromats and the corresponding control field.</p><pre><code class="nohighlight hljs">### Parameters:
- `cf::ControlField`: The control field object containing the RF waveform data (`B1x`, `B1y` components).
- `isos::Vector{Isochromat}`: A vector of isochromat objects representing different spin systems.

### Returns:
- A plot object displaying:
    1. The magnetization trajectory in the transverse plane.
    2. The control field amplitude and phase over time.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/plots/plots_control_field.jl#L101-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.plot_transverse_magnetization-Tuple{Vector{Isochromat}}" href="#GrapeMR.plot_transverse_magnetization-Tuple{Vector{Isochromat}}"><code>GrapeMR.plot_transverse_magnetization</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>2D Magnetization Plots</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/plots/plots_magnetization.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.random_sampler-Tuple{Vector{&lt;:Spins}, GrapeParams, LinRange, StepRange}" href="#GrapeMR.random_sampler-Tuple{Vector{&lt;:Spins}, GrapeParams, LinRange, StepRange}"><code>GrapeMR.random_sampler</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">random_sampler(spins::Vector{&lt;:Spins}, 
              gp::GrapeParams, 
              Tc::LinRange, 
              max_iter::StepRange; 
              i::Int=50, 
              poly_start::Vector{Float64}=[1e-1, 1e-2], 
              poly_degree::Vector{Int}=[1, 2, 3], 
              B1ref::Float64=1.0)</code></pre><p>Performs random sampling for hyperparameter optimization.</p><pre><code class="nohighlight hljs">### Input
- `spins::Vector{&lt;:Spins}`: A vector containing spin systems for the optimization process.
- `gp::GrapeParams`: Grape algorithm parameters, which include time points, cost function, and mask for which fields are being optimized.
- `Tc::LinRange`: Range for the time control points for spline interpolation.
- `max_iter::StepRange`: Range for the maximum number of iterations for the optimizer.
- `i::Int=50`: Number of random samples to evaluate.
- `poly_start::Vector{Float64}=[1e-1, 1e-2]`: Starting points for the polynomial learning rate.
- `poly_degree::Vector{Int}=[1, 2, 3]`: Degrees for the polynomial learning rate.
- `B1ref::Float64=1.0`: Reference B1 field amplitude for the RF pulse.

### Output
- A random hyperparameter optimization object using random sampling.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/optimization/hyperparameter_opt.jl#L4-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.run_cost_analysis-Tuple{ControlField, Spins, Float64, Int64, Symbol}" href="#GrapeMR.run_cost_analysis-Tuple{ControlField, Spins, Float64, Int64, Symbol}"><code>GrapeMR.run_cost_analysis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_cost_analysis(grape_output::GrapeOutput, offset::Float64, b1_inhomogeneity_percent::Int)</code></pre><p>Runs a complete cost analysis for the specified <code>GrapeOutput</code> object over a range of B0 and B1 inhomogeneities,  and generates plots to visualize the cost function.</p><pre><code class="nohighlight hljs"># Arguments
- `control_field::ControlField`: The control field object that contains the RF pulse sequence.
- `spin_system::Spin`: The spin system for which the cost function is to be calculated.
- `offset::Float64`: The range of offset frequencies (in Hz) for the B0 inhomogeneities.
- `b1_inhomogeneity_percent::Int`: The percentage of B1 inhomogeneity to consider for the analysis.

# Workflow
1. Generates a range of B0 values from `-offset` to `offset`.
2. Computes cost values for the specified B0 and B1 inhomogeneities using `cost_offsets` and `create_cost_matrix`.
3. Plots the cost function offset profile using `plot_cost_offset`.
4. Generates a heatmap of the cost matrix using `heatmap_cost`.
5. Creates a contour plot of the cost matrix using `countour_cost`.

# Example
run_cost_analysis(grape_output, 50.0, 30)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/analysis/cost_analysis.jl#L168-L189">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.save_bohb_data-Tuple{Any}" href="#GrapeMR.save_bohb_data-Tuple{Any}"><code>GrapeMR.save_bohb_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_bohb_data(bohb::GrapeMR.GrapeOutput; folder_path = pwd())</code></pre><p>Save data related to BOHB optimization into a folder organized by date.</p><p><strong>Arguments</strong></p><ul><li><code>bohb::GrapeMR.GrapeOutput</code>: The output from a BOHB optimization process.</li><li><code>folder_path::String = pwd()</code>: The folder path where data will be saved. Defaults to the current working directory.</li></ul><p><strong>Output</strong></p><p>Returns the full path to the folder where the data was saved.</p><p><strong>Saved Files</strong></p><ul><li><code>bohb.jld2</code>: Contains BOHB result in JLD2 format.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/utilities/save_data.jl#L70-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.save_grape_data-Tuple{GrapeOutput}" href="#GrapeMR.save_grape_data-Tuple{GrapeOutput}"><code>GrapeMR.save_grape_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_grape_data(go::GrapeMR.GrapeOutput; folder_path = pwd())</code></pre><p>Save data related to GRAPE optimization into a folder organized by date.</p><p><strong>Arguments</strong></p><ul><li><code>go::GrapeMR.GrapeOutput</code>: The output from a GRAPE optimization process.</li><li><code>folder_path::String = pwd()</code>: The folder path where data will be saved. Defaults to the current working directory.</li></ul><p><strong>Output</strong></p><p>Returns the full path to the folder where the data was saved.</p><p><strong>Saved Files</strong></p><ul><li><code>grape_output.jld2</code>: Contains the entire <code>GrapeOutput</code> struct in JLD2 format.</li><li><code>dict_cost_values.csv</code>: CSV file containing the cost values from the optimization process.</li><li><code>dict_control_field.csv</code>: CSV file containing control field values (B1x, B1y, Bz, and RF time).</li><li><code>dict_iso_spins.csv</code>: CSV file containing isochromat spin parameters.</li></ul><p>If no path is provided, it saves the files inside the folder where the package was installed folder name format : yyyy-mm-dd</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/utilities/save_data.jl#L24-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.sinc_RF-Tuple{Int64, Float64, Float64}" href="#GrapeMR.sinc_RF-Tuple{Int64, Float64, Float64}"><code>GrapeMR.sinc_RF</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sinc_RF(N::Int, t_c::Float64, BW_Hz::Real, flip_angle::Float64)</code></pre><p>Generates a sinc pulse with bandwidth BW and flip angle flip_angle in radians</p><p><strong>Arguments</strong></p><ul><li><code>N::Int</code>: Points</li><li><code>t_c::Float64</code>: Shaped pulse time in seconds</li><li><code>BW_Hz::Real</code>: Pulse bandwidth</li><li><code>flip_angle::Float64</code>: Flip angle</li></ul><p><strong>Output</strong></p><ul><li>1xN array with sinc pulse amplitudes</li></ul><p><strong>Example</strong></p><p>```julia bSSFP(gp<em>output, folder</em>path=&quot;/path/to/folder&quot;)</p><p>If no path is provided, it saves the files inside the folder where the package was installed folder name format : yyyy-mm-dd</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/utilities/rf_shapes.jl#L128-L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.spline_RF-Tuple{Any, Any, Any}" href="#GrapeMR.spline_RF-Tuple{Any, Any, Any}"><code>GrapeMR.spline_RF</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spline_RF(N::Int, t_c::Float64)</code></pre><p>Generates a cubic spline pulse </p><p><strong>Arguments</strong></p><ul><li><code>N::Int</code>: Points</li><li><code>t_c::Float64</code>: Shaped pulse time in seconds</li><li><code>B1_ref::Float64</code>: Reference, normally pulse maximum amplitude</li></ul><p><strong>Output</strong></p><ul><li>ControlField struct </li></ul><p><strong>Example</strong></p><p>```julia bSSFP(gp<em>output, folder</em>path=&quot;/path/to/folder&quot;)</p><p>If no path is provided, it saves the files inside the folder where the package was installed folder name format : yyyy-mm-dd</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/utilities/rf_shapes.jl#L1-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.steady_state-Tuple{SteadyState}" href="#GrapeMR.steady_state-Tuple{SteadyState}"><code>GrapeMR.steady_state</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">steady_state(s::GrapeMR.SteadyState)</code></pre><p>Calculates the steady-state signal of a bSSFP sequence for a given set of parameters. The function calculates the magnetization evolution  using repeated RF excitations and free precession steps until the steady state is reached.</p><pre><code class="nohighlight hljs"># Arguments
- `s::GrapeMR.SteadyState`: A struct containing TR (Repetition Time), TE (Echo Time), T1 (Spin-lattice relaxation time), 
                            T2 (Spin-spin relaxation time), α (Flip angle in radians), Δϕ (Phase cycling increment), 
                            M_init (Initial magnetization vector), and B0inho (B0 inhomogeneity).
# Returns
- `signal::Vector{ComplexF64}`: The complex steady-state signal of the spin system.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/bSSFP/steady_state.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.steady_state_geometric-Tuple{SteadyState}" href="#GrapeMR.steady_state_geometric-Tuple{SteadyState}"><code>GrapeMR.steady_state_geometric</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">steady_state_geometric(s::GrapeMR.SteadyState)</code></pre><p>Calculates the transverse steady-state magnetization using a geometric solution for a bSSFP sequence. Uses a geometric approach to  derive the transverse component of the steady-state magnetization.</p><pre><code class="nohighlight hljs"># Arguments
- `s::GrapeMR.SteadyState`: Struct containing the sequence parameters and spin system properties.

# Returns
- `Mxy::Vector{Float64}`: The steady-state transverse magnetization magnitude `Mxy`</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/bSSFP/steady_state.jl#L106-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.steady_state_geometric_Mz-Tuple{SteadyState}" href="#GrapeMR.steady_state_geometric_Mz-Tuple{SteadyState}"><code>GrapeMR.steady_state_geometric_Mz</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">steady_state_geometric_Mz(s::GrapeMR.SteadyState)</code></pre><p>Calculates the longitudinal steady-state magnetization using a geometric solution for a bSSFP sequence. Uses a geometric approach to  derive the longitudinal component of the steady-state magnetization.</p><pre><code class="nohighlight hljs"># Arguments
- `s::GrapeMR.SteadyState`: Struct containing the sequence parameters and spin system properties.

# Returns
- `Mz::Vector{Float64}`: The steady-state longitudinal magnetization magnitude `Mz`</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/bSSFP/steady_state.jl#L128-L139">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GrapeMR.update!-Tuple{ControlField, Tuple{Matrix{Float64}, Matrix{Float64}}, Float64}" href="#GrapeMR.update!-Tuple{ControlField, Tuple{Matrix{Float64}, Matrix{Float64}}, Float64}"><code>GrapeMR.update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update(cf::ControlField, ∇xy::Tuple, ϵ::Float64)</code></pre><p>update     # Input       - cf:  (::ControlField) - Control fields struct     - ∇xy: (::Tuple) - Calculated gradients for x and y components     - ϵ:   (::Float64) - Weigth of gradient</p><pre><code class="nohighlight hljs"># Output
- Control Field - 1xN matrix</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/amandanicotina/GrapeMR.jl/blob/494fed3048f1b640f2797402899547593e9187bf/src/optimization/optimize.jl#L125-L136">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial/">« Tutorial</a><a class="docs-footer-nextpage" href="../references/">References »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Saturday 26 October 2024 10:09">Saturday 26 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
